"use strict";var J=Object.defineProperty;var a=(e,t)=>J(e,"name",{value:t,configurable:!0});var I=require("./get-pipe-path-BoR10qr8.cjs"),d=require("node:module"),p=require("node:path"),w=require("node:url"),y=require("get-tsconfig"),Q=require("node:fs"),b=require("./index-CoHsQGpm.cjs"),M=require("./client-D6NvIMSC.cjs");const k=[".js",".json",".ts",".tsx",".jsx"],g=Object.create(null);g[".js"]=[".ts",".tsx",".js",".jsx"],g[".jsx"]=[".tsx",".ts",".jsx",".js"],g[".cjs"]=[".cts"],g[".mjs"]=[".mts"];const S=a((e,t)=>{const[s,n]=e.split("?"),r=p.extname(s),o=r?g[r]:t?k:void 0;if(!o)return;const c=r?s.slice(0,-r.length):s;return o.map(i=>c+i+(n?`?${n}`:""))},"mapTsExtensions"),B=a(e=>{const t=e.indexOf(":");if(t!==-1)return e.slice(0,t)},"getScheme"),T=a(e=>e[0]==="."&&(e[1]==="/"||e[1]==="."||e[2]==="/"),"isRelativePath"),z=a(e=>T(e)||p.isAbsolute(e),"isUnixPath"),G=a(e=>{if(z(e))return!0;const t=B(e);return t&&t!=="node"},"requestAcceptsQuery"),R="file://",U=/\.([cm]?ts|[tj]sx)($|\?)/,H=/\.json($|\?)/,X=/\/(?:$|\?)/,L=/^(?:@[^/]+\/)?[^/\\]+$/;exports.fileMatcher=void 0,exports.tsconfigPathsMatcher=void 0,exports.allowJs=!1;const D=a(e=>{let t=null;if(e){const s=p.resolve(e);t={path:s,config:y.parseTsconfig(s)}}else{try{t=y.getTsconfig()}catch{}if(!t)return}exports.fileMatcher=y.createFilesMatcher(t),exports.tsconfigPathsMatcher=y.createPathsMatcher(t),exports.allowJs=t?.config.compilerOptions?.allowJs??!1},"loadTsconfig"),E=a(e=>Array.from(e).length>0?`?${e.toString()}`:"","urlSearchParamsStringify"),$=[".ts",".tsx",".jsx"],A=a((e,...t)=>{for(const s of $){const n=t.slice();n[0]+=s;try{return e(...n)}catch{}}},"tryExtensions"),K=a(e=>(t,...s)=>{try{return e(t,...s)}catch(n){const r=n;if(r.code==="MODULE_NOT_FOUND"&&!L.test(t)){const o=A(e,t,...s)||A(e,`${t}${p.sep}index`,...s);if(o)return o}throw r}},"createImplicitResolver"),V=`${p.sep}node_modules${p.sep}`,F=a(e=>{if(!e.startsWith("data:text/javascript,"))return;const t=e.indexOf("?");if(t===-1)return;const n=new URLSearchParams(e.slice(t+1)).get("filePath");if(n)return n},"getOriginalFilePath"),N=a(e=>{const t=F(e);return t&&(d._cache[t]=d._cache[e],delete d._cache[e],e=t),e},"interopCjsExports"),j=a((e,t,s)=>{if(!(s?.filename&&U.test(s.filename))&&!exports.allowJs)return;const n=S(t);if(n)for(const r of n)try{return e(r)}catch(o){const{code:c}=o;if(c!=="MODULE_NOT_FOUND"&&c!=="ERR_PACKAGE_PATH_NOT_EXPORTED")throw o}},"resolveTsFilename"),Y=a((e,t,s)=>{if(e.startsWith(R)&&(e=w.fileURLToPath(e)),exports.tsconfigPathsMatcher&&!T(e)&&!t?.filename?.includes(V)){const r=exports.tsconfigPathsMatcher(e);for(const o of r){const c=j(s,o,t);if(c)return c;try{return s(o)}catch{}}}const n=j(s,e,t);if(n)return n;try{return s(e)}catch(r){const o=r;if(o.code==="MODULE_NOT_FOUND"&&typeof o.path=="string"&&o.path.endsWith(`${p.sep}package.json`)){const c=o.message.match(/^Cannot find module '([^']+)'$/);if(c){const m=c[1],l=j(s,m,t);if(l)return l}const i=o.message.match(/^Cannot find module '([^']+)'. Please verify that the package.json has a valid "main" entry$/);if(i){const m=i[1],l=j(s,m,t);if(l)return l}}throw o}},"resolveRequest"),Z=a((e,t)=>(s,n,r,o)=>{const c=a(h=>e(h,n,r,o),"resolve");if(s=N(s),n?.filename){const h=F(n.filename);h&&(n.filename=h.split("?")[0])}const i=s.split("?"),m=new URLSearchParams(i[1]);if(n?.filename){const P=new URLSearchParams(n.filename.split("?")[1]).get("namespace");P&&m.append("namespace",P)}if((m.get("namespace")??void 0)!==t)return c(s);t&&(e=K(e));let l=Y(i[0],n,c);return p.isAbsolute(l)&&!l.endsWith(".json")&&!l.endsWith(".node")&&(l+=E(m)),l},"createResolveFilename"),q=`
//# sourceMappingURL=data:application/json;base64,`,W=a(()=>process.sourceMapsEnabled??!0,"shouldApplySourceMap"),v=a(({code:e,map:t})=>e+q+Buffer.from(JSON.stringify(t),"utf8").toString("base64"),"inlineSourceMap"),ee=[".cts",".mts",".ts",".tsx",".jsx"],te=[".js",".cjs",".mjs"],se=a(e=>{const t=Object.create(Object.getPrototypeOf(e)),s=Object.getOwnPropertyDescriptors(e);for(const n in s)Object.hasOwn(s,n)&&Object.defineProperty(t,n,s[n]);return t},"cloneExtensions"),O=a((e,t,s,n)=>{const r=Object.getOwnPropertyDescriptor(e,t);r?.set?e[t]=s:(!r||r.configurable)&&Object.defineProperty(e,t,{value:s,enumerable:r?.enumerable||n?.enumerable,writable:n?.writable??(r?r.writable:!0),configurable:n?.configurable??(r?r.configurable:!0)})},"safeSet"),ne=a((e,t)=>{const s=se(e),n=s[".js"],r=a((o,c)=>{const[i,m]=c.split("?");if((new URLSearchParams(m).get("namespace")??void 0)!==t)return n(o,i);M.parent?.send&&M.parent.send({type:"dependency",path:i});const h=ee.some(f=>i.endsWith(f)),P=te.some(f=>i.endsWith(f));if(!h&&!P)return n(o,i);let u=Q.readFileSync(i,"utf8");if(i.endsWith(".cjs")){const f=b.transformDynamicImport(c,u);f&&(u=W()?v(f):f.code)}else if(h||b.isESM(u)){const f=b.transformSync(u,c,{tsconfigRaw:exports.fileMatcher?.(i)});u=W()?v(f):f.code}o._compile(u,i)},"transformer");O(s,".js",r);for(const o of $)O(s,o,r,{enumerable:!t,writable:!0,configurable:!0});return O(s,".mjs",r,{writable:!0,configurable:!0}),s},"createExtensions"),C=a((e,t)=>{if(!t)throw new Error("The current file path (__filename or import.meta.url) must be provided in the second argument of tsx.require()");return(typeof t=="string"&&t.startsWith("file://")||t instanceof URL)&&(t=w.fileURLToPath(t)),p.resolve(p.dirname(t),e)},"resolveContext"),re=a(e=>{const{sourceMapsEnabled:t}=process,{_extensions:s,_resolveFilename:n}=d;D(process.env.TSX_TSCONFIG_PATH),process.setSourceMapsEnabled(!0);const r=Z(n,e?.namespace);d._resolveFilename=r;const o=ne(d._extensions,e?.namespace);d._extensions=o;const c=a(()=>{t===!1&&process.setSourceMapsEnabled(!1),d._extensions=s,d._resolveFilename=n},"unregister");if(e?.namespace){const i=a((l,h)=>{const P=C(l,h),[u,f]=P.split("?"),x=new URLSearchParams(f);return e.namespace&&x.set("namespace",e.namespace),I.require(u+E(x))},"scopedRequire");c.require=i;const m=a((l,h,P)=>{const u=C(l,h),[f,x]=u.split("?"),_=new URLSearchParams(x);return e.namespace&&_.set("namespace",e.namespace),r(f+E(_),module,!1,P)},"scopedResolve");c.resolve=m,c.unregister=c}return c},"register");exports.fileUrlPrefix=R,exports.inlineSourceMap=v,exports.interopCjsExports=N,exports.isBarePackageNamePattern=L,exports.isDirectoryPattern=X,exports.isJsonPattern=H,exports.loadTsconfig=D,exports.mapTsExtensions=S,exports.register=re,exports.requestAcceptsQuery=G,exports.tsExtensionsPattern=U;
